# v1.2.0 (2025-11-25)

## 今回の主な追加点（JMA統合）
- 気象庁の雨量データ取得ツール（JMA）を本リポジトリに統合し、ランチャーから water_info と並列で起動できるようにしました。
- ランチャー→子ウィンドウ（Toplevel）構成により、両ツール間の行き来をメニュー経由でシームレスに実行できます。
- 出力・ログ・パス解決を JMA 側でも本体とそろえ、config 不在時でもデフォルトパスで動作するようにしています。

## ハイライト
 - ランチャーで最初に water_info / JMA を選択し、各ツールは単一の Tk ルート＋Toplevel で起動（子を閉じれば終了、メニューで相互遷移も可）。PyInstaller ビルド後も `main.py` から利用できます。
- アプリ名称・バージョンを `src/app_names.py` と `pyproject.toml` に一元管理。ランチャー上にバージョンを表示し、メニューラベルも共通の定義を参照。
- JMA GUIの初期化を非同期化（都道府県一覧の取得をバックグラウンド化）し、リスト上のオーバーレイで進行状況を可視化。起動待ち時間を短縮しました。
- 設定ファイル（config.yml）が無い場合でもデフォルト出力先で動作。ログも `jma_rainfall/logs/app.log` に統一し、凍結（exe）時は実行ファイルの親を基準に解決します。

## 変更内容
- `main.py` → `src/launcher.py` 経由で water_info / JMA を起動し、子ウィンドウ閉鎖時にランチャーへ戻るフローに統一。
- `src/app_names.py` を追加し、アプリ/モジュールの日本語・英語名とバージョン取得（pyproject.toml または importlib.metadata）を集中管理。
- JMA `browse_tab.py`:  
  - 都道府県一覧取得を非同期化し、リスト上にオーバーレイで「読み込み中」を表示（観測所リストは通常表示のまま）。  
  - 出力先の強制指定を撤廃し、`config.yml` 不在時はデフォルト（`jma_rainfall/csv` など）を自動使用。  
  - 依存モジュール（fetcher/controller）の import を遅延化し、初期起動を軽量化。
- JMA ロガー: モジュール import 時の初期化をやめ、`get_logger()` 呼び出し時に初期化する遅延実行に変更。デフォルトログ出力を `jma_rainfall/logs/app.log` へ統一。
- メニューバー: water_info / JMA 双方向の遷移ボタンをメニューに集約し、JMAヘルプもメニューに移動。ランチャーのラベルやメニュー表示が `app_names` を参照するように整備。

## 開発者向けトピック
- PyInstaller ビルド例（Windows, dir/onefile）を `.github/workflows/build.yml` に反映。`--paths src` と `pyproject.toml` 同梱を明示。
- ルートパス解決を `path_utils.get_project_root()` で共通化し、凍結時は実行ファイル親を返すよう調整。
- ログ設定失敗時のフォールバックを `basicConfig` で確保（遅延初期化後も安全に動作）。

## 既知の注意事項
- 初回起動時は都道府県一覧の取得が完了するまでオーバーレイ表示となります（ネットワーク状況に依存）。
